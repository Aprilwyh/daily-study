<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>

<body>
  <script>
    // 2020-06-11 6.20-7.20

    // codePointAt()
    // ES5: charCodeAt

    // String.fromCodePoint()
    // ES5: String.fromCharCode
    // 字符串遍历器接口
    for (let code of 'foo') {
      console.log(code); // "f" "o" "o"
    }
    var text = String.fromCodePoint(0x20BB7);
    for (let i = 0; i < text.length; i++) {
      console.log(text); // 输出两个 "𠮷", 书中例子是输出两个空，可能因为浏览器版本高？
    }
    for (let i of text) {
      console.log(text); // 输出一个 "𠮷"
    }
    // at() // ES5: charAt() 返回字符串给定位置的字符
    // 今日灵魂拷问：如何用ES5实现at功能？其他功能也可以试试

    // normalize()
    // 欧洲语言有语调和重音符号，后续补吧

    // includes()、startsWith()、endsWith()
    // ES5: indexOf() 确定一个字符串是否包含在另一个字符串中
    var s = 'hello world';
    s.startsWith('h'); // true, 以他开头
    s.endsWith('l'); // false, 不以他结尾
    s.includes('r'); // true, 包含他 太好了以后不用indexOf !== -1了
    // 第二个参数表示开始搜索的位置
    s.startsWith('h', 6); // false
    s.endsWith('d', 1); // false endsWith和其他两个方法不同，它针对前n个字符。其他方法针对n到结束之间的字符
    s.includes('r', 8); // true 说明从索引8开始且包含8

    // repeat() 返回一个新字符串，将原字符串重复n次
    'x'.repeat(3); // xxx
    'hello'.repeat(2); // hellohello
    'na'.repeat(0); // ""
    'na'.repeat(2.9); // nana 参数是小数向下取整（* 0到-1的小数会被视为-0，等同于0）
    // 参数如果是负数或者Infinity会报错
    // 参数如果是字符串会转换成数字

    // padStart()、padEnd() 字符串不够指定长度 头部补全/尾部补全
    'x'.padStart(5, 'ab'); // ababx
    'x'.padEnd(4, 'ab'); // xaba
    // 原字符串的长度 >= 指定长度，返回原字符串（不会被截取）
    // 原字符串长度 + 补全字符串长度 > 指定长度，截去超出位数的补全字符串
    // 总之不会截掉原字符串，要么补要么不动他
    'x'.padStart(2); // ' x' 省略第二个参数空格会补全
    'x'.padEnd(2); // 'x '
    // 用途是为数值补全指定位数、提示字符串格式等
    '1'.padStart(3, '0'); // 001
    '01-01'.padStart(10, 'YYYY-MM-DD'); // 'YYYY-01-01'

    // 2020-06-12 6.50-7.20

    // 模板字符串
    // 字符串中嵌入变量,模板字符串中的变量没有声明会报错
    var name = "Tom", time = "today";
    `Hello ${name}, how are you ${time}?`
    // 字符串中调用函数(假设fn已定义)
    // `123 ${fn()} 456`
    // trim方法消除模板字符串中的空格和缩进
    /* $('#list').html(`
    <ul>
      <li>123</li>
    </ul>
    `.trim()); */
    // ${}中的值不是字符串将转为字符串（默认调用toString()方法）
    // 模板字符串可以嵌套
    const tmp1 = addrs => `
      <table>
        ${addrs.map(addr => `
          <tr><td>${addr.first}</td></tr>
          <tr><td>${addr.last}</td></tr>
        `).join('')}
      </table>
    `
    const data = [
      { first: '<Tom>', last: 'Bond' },
      { first: 'Lars', last: '<Croft>' }
    ];
    console.log(tmp1(data));
    // 引用模板字符串本身，两种写法
    let str1 = 'return ' + '`Hello ${name}`';
    let func1 = new Function('name', str1);
    console.log(func1('Tom')); // Hello Tom
    let str2 = '(name) => `Hello ${name}`';
    let func2 = eval.call(null, str2);
    console.log(func2('Jerry')); // Hello Jerry

    // 2020-06-15 6.30-7.20

    // 标签模板
    alert`123`;
    alert(123); // 与上面相等
    var a = 5;
    var b = 10;
    tag`Hello ${a + b} world ${a * b}`;
    tag(['Hello', 'world', ''], 15, 50); // 与上面相等
    // tag的第一个参数是数组，成员是模板字符串中没有变量替换的部分
    function tag(s, v1, v2) {
      console.log(s[0]); // Hello
      console.log(s[1]); // world
      console.log(s[2]); // 
      console.log(v1); // 15
      console.log(v2); // 50
      return "OK";
    }
    // 将各个参数按照原来的位置拼接回去


  </script>
</body>

</html>